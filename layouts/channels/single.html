{{ define "main" }}
  <h1 class="heading">{{ .Title }}</h1>

  {{ if in .Permalink "/new" }}
    {{ partial "channels/new.html" . }}
  {{ else }}
    {{ $channels := $.Site.Data.channels }}
    {{ $channelSlug := index (split .Page.RelPermalink "/") 2 }}
    {{ $scratch := newScratch }}
    {{ range $channels }}
      {{ if eq .slug $channelSlug }}
        {{ $scratch.Set "channel" . }}
      {{ end }}
    {{ end }}
    {{ $channel := $scratch.Get "channel" }}
    {{ with $channel.providers.youtube }}
      <a href="{{ .url }}">YouTube</a>
    {{ end }}
    {{ with $channel.providers.patreon }}
      <a href="{{ .url }}">Patreon</a>
    {{ end }}

    {{ partial "channels/videos.html" . }}
  {{ end }}
{{ end }}
