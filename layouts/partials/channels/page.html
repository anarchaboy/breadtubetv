{{ $channelSlug := index (split .Page.RelPermalink "/") 2 }}
{{ $channels := $.Site.Data.channels }}
{{ $scratch := newScratch }}
{{ range $channels }}
  {{ if eq .slug $channelSlug }}
    {{ $scratch.Set "channel" . }}
  {{ end }}
{{ end }}
{{ $channel := $scratch.Get "channel" }}

{{ with $channel.providers.youtube }}
  <a href="{{ .url }}">YouTube</a>
{{ end }}
{{ with $channel.providers.patreon }}
  <a href="{{ .url }}">Patreon</a>
{{ end }}

<ul class="list plain-list">
  {{ $videos := $.Site.Data.videos }}
  {{ range $channelSlug, $channelVideos := $videos }}
    {{ range $videoID, $video := $channelVideos }}
      {{ if eq $channel.slug $video.channel }}
        {{ partial "videos/card.html" (dict "video" $video "channel" $channel) }}
      {{ end }}
    {{ end }}
  {{ end }}
</ul>
