{{ $videos := $.Site.Data.videos }}
{{ $videoChannel := (or (in .Permalink "playlist") (eq true .Params.videoChannel)) }}
{{ $videoIframe := (eq true .Params.videoIframe) }}

<ul class="list plain-list">
  {{- range .Params.videos -}}
    {{- $id := . -}}
    {{- range $channelSlug, $channelVideos := $videos -}}
      {{- range $videoID, $video := $channelVideos -}}
        {{- if eq $id $videoID -}}
          {{- $channelPage := (printf "/channels/%s" $channelSlug) -}}
          {{ with $.Site.GetPage $channelPage }}
            {{ $channel := . }}
            {{ partial "videos/card.html" (dict "video" $video "channel" $channel "videoChannel" $videoChannel "videoIframe" $videoIframe) }}
          {{ end }}
        {{- end -}}
      {{- end -}}
    {{- end -}}
  {{- end -}}
</ul>
